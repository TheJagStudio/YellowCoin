{% extends 'base.html' %}
{% block title %}Watchlist{% endblock %}
{% block content %}
<div class="col-12 col-sm-12 col-md-8 col-lg-12 col-xl-12">
   <div class="react-reveal container-fluid" style="animation-fill-mode: both;
      animation-duration: 1000ms; animation-delay: 0ms;
      animation-iteration-count: 1; opacity: 1; animation-name:
      react-reveal-35245370716331-1;">
      <div class="row my-1">
         <div class="col-1 text-end p-0 m-0 fs-small">
            <button id="CusDropdown" class="text-start"
               onclick="navBarChanger()" value="down" style="width: fit-content
               ;height: fit-content ; margin: 3px; border:none;
               background-color: white" type="button">
               <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"
                  fill="#fab417" class="bi bi-arrow-up-square-fill" viewBox="0 0
                  16 16">
                  <path d="M2 16a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12a2 2 0 0 1 2
                     2v12a2 2 0 0 1-2 2H2zm6.5-4.5V5.707l2.146 2.147a.5.5 0 0 0
                     .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0
                     .708.708L7.5 5.707V11.5a.5.5 0 0 0 1 0z" />
                  </svg>
               </button>
            </div>
            <script> 
                           function navBarChangerHover(data)
                           {
                              var btn = document.getElementById("CusDropdown");
                              if(data == 0)
                              {
                                 btn.value = "up";
                                 btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#fab417" class="bi bi-arrow-down-square-fill" viewBox="0 0 16 16">
                                    <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm6.5 4.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5a.5.5 0 0 1 1 0z"/>
                                 </svg>`;
                                 document.getElementById("cusNav").style.opacity = 0;
                                 document.getElementById("cusNav").style.transitionDelay = "2s";
                                 document.getElementById("cusNav").style.transition = "opacity 0.1s";
                                 document.getElementById("cusNav").style.transform = "translateY(-75%)";
                                 document.getElementById("extraHeight").style.height = "0rem";
                                 document.getElementById("extraHeight").style.transition = "height 0.5s";
                              }
                              else
                              {
                                 btn.value = "down";
                                 btn.innerHTML = `<svg  xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#fab417" class="bi bi-arrow-up-square-fill" viewBox="0 0 16 16">
                                    <path d="M2 16a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2zm6.5-4.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 1 0z"/>
                                 </svg>`;
                                 document.getElementById("cusNav").style.opacity = 1;
                                 document.getElementById("cusNav").style.transitionDelay = "2s";
                                 document.getElementById("cusNav").style.transition = "opacity 0.5s";
                                 document.getElementById("cusNav").style.transform = "translateY(0)";
                                 document.getElementById("extraHeight").style.height = "5rem";
                                 document.getElementById("extraHeight").style.transition = "height 0.5s";
                              }
                           }
                           function navBarChanger()
                           {
                              var btn = document.getElementById("CusDropdown");
                              var value = btn.value;
                              if(value == "down")
                              {
                                 btn.value = "up";
                                 btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#fab417" class="bi bi-arrow-down-square-fill" viewBox="0 0 16 16">
                                    <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm6.5 4.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5a.5.5 0 0 1 1 0z"/>
                                 </svg>`;
                                 document.getElementById("cusNav").style.opacity = 0;
                                 document.getElementById("cusNav").style.transition = "opacity 0.5s";
                                 document.getElementById("cusNav").style.transform = "translateY(-80%)";
                                 document.getElementById("extraHeight").style.height = "0rem";
                                 document.getElementById("extraHeight").style.transition = "height 0.5s";
                              }
                              else
                              {
                                 btn.value = "down";
                                 btn.innerHTML = `<svg  xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#fab417" class="bi bi-arrow-up-square-fill" viewBox="0 0 16 16">
                                    <path d="M2 16a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2zm6.5-4.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 1 0z"/>
                                 </svg>`;
                                 document.getElementById("cusNav").style.opacity = 1;
                                 document.getElementById("cusNav").style.transition = "opacity 0.5s";
                                 document.getElementById("cusNav").style.transform = "translateY(0)";
                                 document.getElementById("extraHeight").style.height = "5rem";
                                 document.getElementById("extraHeight").style.transition = "height 0.5s";
                              }
                           }
                           </script>
            <div class="col-2 text-end p-0 m-0 fs-small">
               <span>SNX : {{senty.1.0.1}} - {{senty.1.0.4}} </span>
               <p>NFT : {{senty.0.0.1}} - {{senty.0.0.4}} &nbsp; </p>
            </div>
            <div class="col-9 col-sm-9 col-md-9 col-lg-6 col-xl-6">
               <div class="input-group shadow-sm">
                  <span class="input-group-text focus-none bg-transparent
                     border-right-none" id="basic-addon1">
                     <svg aria-hidden="true" class="svg-inline--fa
                        fa-magnifying-glass hover-search" color="#fab417"
                        data-icon="magnifying-glass" data-prefix="fas"
                        focusable="false" role="img" viewbox="0 0 512 512"
                        xmlns="http://www.w3.org/2000/svg">
                        <path d="M500.3 443.7l-119.7-119.7c27.22-40.41
                           40.65-90.9 33.46-144.7C401.8 87.79 326.8 13.32 235.2
                           1.723C99.01-15.51-15.51 99.01 1.724 235.2c11.6 91.64
                           86.08 166.7 177.6 178.9c53.8 7.189 104.3-6.236
                           144.7-33.46l119.7 119.7c15.62 15.62 40.95 15.62 56.57
                           0C515.9 484.7 515.9 459.3 500.3 443.7zM79.1
                           208c0-70.58 57.42-128 128-128s128 57.42 128 128c0
                           70.58-57.42 128-128 128S79.1 278.6 79.1 208z"
                           fill="currentColor">
                        </path>
                     </svg>
                  </span>
                  <input onkeyup="filter()" id="search"
                     aria-describedby="basic-addon1" aria-label="Username"
                     class="form-control focus-none border-left-none"
                     placeholder="Search..." type="text" />
               </div>
            </div>
         </div>
      </div>
      <div class="container-fluid">
         <div class="row">
            <div class="col-6 col-sm-6 col-md-4 col-lg-2 col-xl-2">
               <p class="m-2 mt-0">SEGMENT</p>
               <select onchange="scriptChanger(this)" id="segment"
                  name="segment" class="form-select bg-orange color-white
                  height-button focus-none" aria-label="Default select example">
                  <option class="bg-light text-dark ps-3" value="NSE">NSE - EQ</option>
                  <option class="bg-light text-dark ps-3" value="NFO">NOPT</option>
                  <option class="bg-light text-dark ps-3" value="MCX">MCX</option>
               </select>
            </div>
            <div class="col-6 col-sm-6 col-md-4 col-lg-3 col-xl-2">
               <p class="m-2 mt-0">SCRIPT</p>
               <input list="scripts" onclick="updateToNull(this)"
                  onchange="ExpirySetter()" value="Type Script" name="script"
                  id="script" class="bg-orange color-white height-button
                  focus-none" style="font-size: .875rem;display: block; width:
                  100%; padding: 0.375rem 2.25rem 0.375rem 0.75rem;
                  -moz-padding-start: calc(0.75rem - 3px); font-size: 1rem;
                  font-weight: 400; line-height: 1.5; color: white; border: 1px
                  solid #ced4da; border-radius:15px; transition: border-color
                  .15s ease-in-out,box-shadow .15s ease-in-out;
                  -webkit-appearance: none; -moz-appearance: none; appearance:
                  none;" aria-label="Default select example">
               <datalist id="scripts">
                  {% for stock in stocksA %}
                  <option value="{{stock}}">
                     {% endfor %}
                  </datalist>
               </div>
               <div class="col-6 col-sm-6 col-md-4 col-lg-3 col-xl-2">
                  <p class="m-2 mt-0">EXPIRY</p>
                  <select name="expiry" id="expiry" onchange="StrikeSetter()"
                     class="form-select bg-orange color-white height-button
                     focus-none" aria-label="Default select example">
                  </select>
               </div>
               <div class="col-6 col-sm-6 col-md-6 col-lg-2 col-xl-1">
                  <p class="m-2 mt-0">CE/PE</p>
                  <select id="typeCall" onchange="StrikeSetter()"
                     class="form-select bg-orange color-white height-button
                     focus-none" aria-label="Default select example">
                     <option class="bg-light text-dark ps-3" value="CE">Call</option>
                     <option class="bg-light text-dark ps-3" value="PE">Put</option>
                  </select>
               </div>
               <div class="col-6 col-sm-6 col-md-6 col-lg-2 col-xl-1">
                  <p class="m-2 mt-0">STRIKE</p>
                  <select id="strike" class="form-select bg-orange color-white
                     height-button focus-none" aria-label="Default select
                     example">
                  </select>
               </div>
               <div class="col-6 col-sm-6 col-md-6 col-lg-2 col-xl-2">
                  <p class="m-2 mt-0">Add New Expiry</p>
                  <input type="date" class="bg-orange date-input color-white
                     w-100 height-button border-none px-3 fs-6 cursor">
               </div>
               <div class="col-6 col-sm-6 col-md-6 col-lg-2 col-xl-2">
                  <p class="m-2 mt-0" style="opacity:0">SUBMIT</p>
                  <button onclick="SubmitData()" class="bg-orange color-white
                     height-button focus-none" style="border-radius:15px; width:
                     70%; border-width: 0;" aria-label="Default select example">
                     Submit
                  </button>
               </div>
            </div>
         </div>
         <div class="ms-3">
            <table class="my-2 bg-dark" style="width: 100%;">
               <thead>
                  <tr class="td-border">
                     <th scope="col" class="bg-dark text-white td-border block">NSE
                        - EQ</th>
                     <th scope="col" class="bg-dark text-white td-border block">BID
                        RATE</th>
                     <th scope="col" class="bg-dark text-white td-border block">ASK
                        RATE</th>
                     <th scope="col" class="bg-dark text-white td-border block">LTP</th>
                     <th scope="col" class="bg-dark text-white td-border block">CHANGE
                        %</th>
                     <th scope="col" class="bg-dark text-white td-border block">OPEN</th>
                     <th scope="col" class="bg-dark text-white td-border block">HIGH</th>
                     <th scope="col" class="bg-dark text-white td-border block">LOW</th>
                     <th scope="col" class="bg-dark text-white td-border block">CLOSE</th>
                     <th scope="col" class="bg-dark text-white td-border block">REMOVE</th>
                  </tr>
               </thead>
               <tbody id="table1">
                  {% for stock in dataNSE %}
                  <tr
                     ondblclick="javascript:location.href='../create_market/?script={{stock.0}}&segment=NSE'"
                     class="">
                     <td class="td-border text-white">{{stock.0}}</td>
                     <td class="td-border text-white bg-primary color-white">{{stock.8}}</td>
                     <td class="td-border text-white bg-primary color-white">{{stock.9}}</td>
                     <td class="td-border text-white bg-primary color-white">{{stock.5}}</td>
                     <td class="td-border text-white">
                        <svg aria-hidden="true" focusable="false"
                           data-prefix="fas" data-icon="caret-up"
                           class="svg-inline--fa fa-caret-up" role="img"
                           xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320
                           512" color="green"><path fill="currentColor" d="M9.39
                              265.4l127.1-128C143.6 131.1 151.8 128 160
                              128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156
                              11.9 22.91 6.943 34.88S300.9 320 287.1
                              320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333
                              274.5 9.39 265.4z"></path></svg>
                        {{stock.7}} %
                     </td>
                     <td class="td-border text-white">{{stock.1}}</td>
                     <td class="td-border text-white">{{stock.2}}</td>
                     <td class="td-border text-white">{{stock.3}}</td>
                     <td class="td-border text-white">{{stock.4}}</td>
                     <td class="td-border text-white">
                        <button type="button" onclick="deleteRNSE(this)"
                           class="btn mx-3 my-0 py-0 the-button">
                           <svg aria-hidden="true" focusable="false"
                              data-prefix="fas" data-icon="xmark"
                              class="svg-inline--fa fa-xmark fa-1x cross-size"
                              role="img" xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 320 512" color="red">
                              <path fill="currentColor" d="M310.6 361.4c12.5
                                 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416
                                 288 416s-16.38-3.125-22.62-9.375L160
                                 301.3L54.63 406.6C48.38 412.9 40.19 416 32
                                 416S15.63 412.9 9.375
                                 406.6c-12.5-12.5-12.5-32.75
                                 0-45.25l105.4-105.4L9.375
                                 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5
                                 45.25 0L160 210.8l105.4-105.4c12.5-12.5
                                 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4
                                 105.4L310.6 361.4z"></path>
                           </svg>
                        </button>
                     </td>
                  </tr>
                  {% endfor %}
               </tbody>
            </table>
         </div>
         <div class="ms-3">
            <table class="my-2 bg-dark" style="width: 100%;">
               <thead>
                  <tr class="td-border">
                     <th scope="col" class="bg-dark text-white block td-border">NOPT</th>
                     <th scope="col" class="bg-dark text-white block td-border">BID
                        RATE</th>
                     <th scope="col" class="bg-dark text-white block td-border">ASK
                        RATE</th>
                     <th scope="col" class="bg-dark text-white block td-border">LTP</th>
                     <th scope="col" class="bg-dark text-white block td-border">CHANGE
                        %</th>
                     <th scope="col" class="bg-dark text-white block td-border">OPEN</th>
                     <th scope="col" class="bg-dark text-white block td-border">HIGH</th>
                     <th scope="col" class="bg-dark text-white block td-border">LOW</th>
                     <th scope="col" class="bg-dark text-white block td-border">CLOSE</th>
                     <th scope="col" class="bg-dark text-white block td-border">REMOVE</th>
                  </tr>
               </thead>
               <tbody id="table3">
                  {% for stock in dataNFO %}
                  <tr
                     ondblclick="javascript:location.href='../create_market/?script={{stock.0}}&segment=NFO'"
                     class="">
                     <td class="td-border text-white">{{stock.0}}</td>
                     <td class="td-border text-white bg-primary color-white">{{stock.8}}</td>
                     <td class="td-border text-white bg-primary color-white">{{stock.9}}</td>
                     <td class="td-border text-white bg-primary color-white">{{stock.5}}</td>
                     <td class="td-border text-white">
                        <svg aria-hidden="true" focusable="false"
                           data-prefix="fas" data-icon="caret-up"
                           class="svg-inline--fa fa-caret-up" role="img"
                           xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320
                           512" color="green"><path fill="currentColor" d="M9.39
                              265.4l127.1-128C143.6 131.1 151.8 128 160
                              128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156
                              11.9 22.91 6.943 34.88S300.9 320 287.1
                              320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333
                              274.5 9.39 265.4z"></path></svg>
                        {{stock.7}} %
                     </td>
                     <td class="td-border text-white">{{stock.1}}</td>
                     <td class="td-border text-white">{{stock.2}}</td>
                     <td class="td-border text-white">{{stock.3}}</td>
                     <td class="td-border text-white">{{stock.4}}</td>
                     <td class="td-border text-white">
                        <button type="button" onclick="deleteRNFO(this)"
                           class="btn mx-3 my-0 py-0 the-button">
                           <svg aria-hidden="true" focusable="false"
                              data-prefix="fas" data-icon="xmark"
                              class="svg-inline--fa fa-xmark fa-1x cross-size"
                              role="img" xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 320 512" color="red">
                              <path fill="currentColor" d="M310.6 361.4c12.5
                                 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416
                                 288 416s-16.38-3.125-22.62-9.375L160
                                 301.3L54.63 406.6C48.38 412.9 40.19 416 32
                                 416S15.63 412.9 9.375
                                 406.6c-12.5-12.5-12.5-32.75
                                 0-45.25l105.4-105.4L9.375
                                 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5
                                 45.25 0L160 210.8l105.4-105.4c12.5-12.5
                                 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4
                                 105.4L310.6 361.4z"></path>
                           </svg>
                        </button>
                     </td>
                  </tr>
                  {% endfor %}
               </tbody>
            </table>
         </div>
         <div class="ms-3">
            <table class="my-2 bg-dark" style="width: 100%;">
               <thead>
                  <tr class="td-border">
                     <th scope="col" class="bg-dark text-white block td-border">MCX
                        SYM</th>
                     <th scope="col" class="bg-dark text-white block td-border">BID
                        RATE</th>
                     <th scope="col" class="bg-dark text-white block td-border">ASK
                        RATE</th>
                     <th scope="col" class="bg-dark text-white block td-border">LTP</th>
                     <th scope="col" class="bg-dark text-white block td-border">CHANGE
                        %</th>
                     <th scope="col" class="bg-dark text-white block td-border">OPEN</th>
                     <th scope="col" class="bg-dark text-white block td-border">HIGH</th>
                     <th scope="col" class="bg-dark text-white block td-border">LOW</th>
                     <th scope="col" class="bg-dark text-white block td-border">CLOSE</th>
                     <th scope="col" class="bg-dark text-white block td-border">REMOVE</th>
                  </tr>
               </thead>
               <tbody id="table2">
                  {% for stock in dataMCX %}
                  <tr
                     ondblclick="javascript:location.href='../create_market/?script={{stock.0}}&segment=MCX'"
                     class="">
                     <td class="td-border text-white">{{stock.0}}</td>
                     <td class="td-border text-white bg-primary color-white">{{stock.8}}</td>
                     <td class="td-border text-white bg-primary color-white">{{stock.9}}</td>
                     <td class="td-border text-white bg-primary color-white">{{stock.5}}</td>
                     <td class="td-border text-white">
                        <svg aria-hidden="true" focusable="false"
                           data-prefix="fas" data-icon="caret-up"
                           class="svg-inline--fa fa-caret-up" role="img"
                           xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320
                           512" color="green"><path fill="currentColor" d="M9.39
                              265.4l127.1-128C143.6 131.1 151.8 128 160
                              128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156
                              11.9 22.91 6.943 34.88S300.9 320 287.1
                              320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333
                              274.5 9.39 265.4z"></path></svg>
                        {{stock.7}} %
                     </td>
                     <td class="td-border text-white">{{stock.1}}</td>
                     <td class="td-border text-white">{{stock.2}}</td>
                     <td class="td-border text-white">{{stock.3}}</td>
                     <td class="td-border text-white">{{stock.4}}</td>
                     <td class="td-border text-white">
                        <button type="button" onclick="deleteRMCX(this)"
                           class="btn mx-3 my-0 py-0 the-button">
                           <svg aria-hidden="true" focusable="false"
                              data-prefix="fas" data-icon="xmark"
                              class="svg-inline--fa fa-xmark fa-1x cross-size"
                              role="img" xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 320 512" color="red">
                              <path fill="currentColor" d="M310.6 361.4c12.5
                                 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416
                                 288 416s-16.38-3.125-22.62-9.375L160
                                 301.3L54.63 406.6C48.38 412.9 40.19 416 32
                                 416S15.63 412.9 9.375
                                 406.6c-12.5-12.5-12.5-32.75
                                 0-45.25l105.4-105.4L9.375
                                 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5
                                 45.25 0L160 210.8l105.4-105.4c12.5-12.5
                                 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4
                                 105.4L310.6 361.4z"></path>
                           </svg>
                        </button>
                     </td>
                  </tr>
                  {% endfor %}
               </tbody>
            </table>
         </div>

      </div>
      <script crossorigin="anonymous">
         window.changer = 1;
            function SubmitData()
            {
                  let segment = document.getElementById("segment").value;
                  let script = document.getElementById("script").value;
                  add(segment,script);
            }
            function add(segment,script)
            {
               if (segment !="NFO")
               {
                  let symbol = script;
                  window.changer = 0;
                     let fetchRes = fetch("../data?apiKey=qwertyuiop&todo=get&symbol=" + symbol+"&segment="+segment);
                     fetchRes.then(res =>
                        res.json()).then(d => {
                              console.log(d)
                              if (segment=="NSE")
                              {
                                 let table1 = document.getElementById('table1');
                                 table1.innerHTML+=`<tr ondblclick="javascript:location.href='../create_market/?script=`+d['data'][0]['name']+`&segment=MCX'" class="">
                                       <td class="td-border text-white">`+d['data'][0]['name']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['bid']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['ask']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['last price']+`</td>
                                       <td class="td-border text-white">
                                          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-up" class="svg-inline--fa fa-caret-up " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="green"><path fill="currentColor" d="M9.39 265.4l127.1-128C143.6 131.1 151.8 128 160 128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156 11.9 22.91 6.943 34.88S300.9 320 287.1 320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333 274.5 9.39 265.4z"></path></svg>
                                          `+d['data'][0]['change']+` %
                                       </td>
                                       <td class="td-border text-white">`+d['data'][0]['open']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['high']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['low']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['close']+`</td>
                                       <td class="td-border text-white">
                                          <button type="button" onclick="deleteRNSE(this)" class="btn  mx-3 my-0 py-0 the-button">
                                             <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="xmark" class="svg-inline--fa fa-xmark fa-1x cross-size" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="red">
                                                <path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"></path>
                                             </svg>
                                          </button>
                                       </td>
                                    </tr>`
                              }
                              else if (segment=="MCX")
                              {
                                 let table2 = document.getElementById('table2');
                                 table2.innerHTML+=`<tr ondblclick="javascript:location.href='../create_market/?script=`+d['data'][0]['name']+`&segment=MCX'" class="">
                                       <td class="td-border text-white">`+d['data'][0]['name']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['bid']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['ask']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['last price']+`</td>
                                       <td class="td-border text-white">
                                          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-up" class="svg-inline--fa fa-caret-up " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="green"><path fill="currentColor" d="M9.39 265.4l127.1-128C143.6 131.1 151.8 128 160 128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156 11.9 22.91 6.943 34.88S300.9 320 287.1 320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333 274.5 9.39 265.4z"></path></svg>
                                          `+d['data'][0]['change']+` %
                                       </td>
                                       <td class="td-border text-white">`+d['data'][0]['open']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['high']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['low']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['close']+`</td>
                                       <td class="td-border text-white">
                                          <button type="button" onclick="deleteRMCX(this)" class="btn  mx-3 my-0 py-0 the-button">
                                             <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="xmark" class="svg-inline--fa fa-xmark fa-1x cross-size" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="red">
                                                <path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"></path>
                                             </svg>
                                          </button>
                                       </td>
                                    </tr>`
                              }
                              else
                              {
                                 let table3 = document.getElementById('table3');
                                 table3.innerHTML+=`<tr ondblclick="javascript:location.href='../create_market/?script=`+d['data'][0]['name']+`&segment=MCX'" class="">
                                       <td class="td-border text-white">`+d['data'][0]['name']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['bid']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['ask']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['last price']+`</td>
                                       <td class="td-border text-white">
                                          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-up" class="svg-inline--fa fa-caret-up " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="green"><path fill="currentColor" d="M9.39 265.4l127.1-128C143.6 131.1 151.8 128 160 128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156 11.9 22.91 6.943 34.88S300.9 320 287.1 320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333 274.5 9.39 265.4z"></path></svg>
                                          `+d['data'][0]['change']+` %
                                       </td>
                                       <td class="td-border text-white">`+d['data'][0]['open']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['high']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['low']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['close']+`</td>
                                       <td class="td-border text-white">
                                          <button type="button" onclick="deleteRNFO(this)" class="btn  mx-3 my-0 py-0 the-button">
                                             <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="xmark" class="svg-inline--fa fa-xmark fa-1x cross-size" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="red">
                                                <path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"></path>
                                             </svg>
                                          </button>
                                       </td>
                                    </tr>`
                              }
                              window.changer = 1;
                              stateChange();
                     });
               }
               else
               {
                  var script = document.getElementById("script").value;
                  var expiry = document.getElementById("expiry").value;
                  var strike = document.getElementById("strike").value;
                  var typeCall = document.getElementById("typeCall").value;
                  let fetchRes = fetch("../scriptChanger/?segment="+segment+"&todo=add&script="+script+"&expiry="+expiry+"&strike="+strike+"&typeCall="+typeCall);
                  fetchRes.then(res =>
                  res.json()).then(d => {
                     let symbol = d.symbol;
                     window.changer = 0;
                     let fetchRes = fetch("../data?apiKey=qwertyuiop&todo=get&symbol=" + symbol+"&segment="+segment);
                     fetchRes.then(res =>
                        res.json()).then(d => {
                              console.log(d)
                              if (segment=="NSE")
                              {
                                 let table1 = document.getElementById('table1');
                                 table1.innerHTML+=`<tr class="">
                                       <td class="td-border text-white">`+d['data'][0]['name']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['bid']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['ask']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['last price']+`</td>
                                       <td class="td-border text-white">
                                          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-up" class="svg-inline--fa fa-caret-up " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="green"><path fill="currentColor" d="M9.39 265.4l127.1-128C143.6 131.1 151.8 128 160 128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156 11.9 22.91 6.943 34.88S300.9 320 287.1 320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333 274.5 9.39 265.4z"></path></svg>
                                          `+d['data'][0]['change']+` %
                                       </td>
                                       <td class="td-border text-white">`+d['data'][0]['open']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['high']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['low']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['close']+`</td>
                                       <td class="td-border text-white">
                                          <button type="button" onclick="deleteRNSE(this)" class="btn  mx-3 my-0 py-0 the-button">
                                             <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="xmark" class="svg-inline--fa fa-xmark fa-1x cross-size" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="red">
                                                <path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"></path>
                                             </svg>
                                          </button>
                                       </td>
                                    </tr>`
                              }
                              else if (segment=="MCX")
                              {
                                 let table2 = document.getElementById('table2');
                                 table2.innerHTML+=`<tr class="">
                                       <td class="td-border text-white">`+d['data'][0]['name']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['bid']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['ask']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['last price']+`</td>
                                       <td class="td-border text-white">
                                          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-up" class="svg-inline--fa fa-caret-up " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="green"><path fill="currentColor" d="M9.39 265.4l127.1-128C143.6 131.1 151.8 128 160 128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156 11.9 22.91 6.943 34.88S300.9 320 287.1 320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333 274.5 9.39 265.4z"></path></svg>
                                          `+d['data'][0]['change']+` %
                                       </td>
                                       <td class="td-border text-white">`+d['data'][0]['open']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['high']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['low']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['close']+`</td>
                                       <td class="td-border text-white">
                                          <button type="button" onclick="deleteRMCX(this)" class="btn  mx-3 my-0 py-0 the-button">
                                             <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="xmark" class="svg-inline--fa fa-xmark fa-1x cross-size" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="red">
                                                <path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"></path>
                                             </svg>
                                          </button>
                                       </td>
                                    </tr>`
                              }
                              else
                              {
                                 let table3 = document.getElementById('table3');
                                 table3.innerHTML+=`<tr class="">
                                       <td class="td-border text-white">`+d['data'][0]['name']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['bid']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['ask']+`</td>
                                       <td class="td-border text-white bg-primary color-white">`+d['data'][0]['last price']+`</td>
                                       <td class="td-border text-white">
                                          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-up" class="svg-inline--fa fa-caret-up " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="green"><path fill="currentColor" d="M9.39 265.4l127.1-128C143.6 131.1 151.8 128 160 128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156 11.9 22.91 6.943 34.88S300.9 320 287.1 320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333 274.5 9.39 265.4z"></path></svg>
                                          `+d['data'][0]['change']+` %
                                       </td>
                                       <td class="td-border text-white">`+d['data'][0]['open']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['high']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['low']+`</td>
                                       <td class="td-border text-white">`+d['data'][0]['close']+`</td>
                                       <td class="td-border text-white">
                                          <button type="button" onclick="deleteRNFO(this)" class="btn  mx-3 my-0 py-0 the-button">
                                             <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="xmark" class="svg-inline--fa fa-xmark fa-1x cross-size" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="red">
                                                <path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"></path>
                                             </svg>
                                          </button>
                                       </td>
                                    </tr>`
                              }
                              window.changer = 1;
                              stateChange();
                     });
                  });
               }
            }
            function deleteRNSE(element)
            {
               console.log("working");
               window.changer = 0;
               let table = document.getElementById('table1');
               console.log(table.rows[element.parentNode.parentNode.rowIndex-1].cells[0].innerHTML);
               let name = table.rows[element.parentNode.parentNode.rowIndex-1].cells[0].innerHTML;
               table.deleteRow(element.parentNode.parentNode.rowIndex-1);
               fetch("../data?apiKey=qwertyuiop&todo=delete&symbol="+ name, 
                  res =>
                  res.json()
               ).then((res) => {
                  console.log(res);
                  window.changer = 1;
                  stateChange();
               });
            }
            function deleteRMCX(element)
            {
               console.log("working");
               window.changer = 0;
               let table = document.getElementById('table2');
               console.log(table.rows[element.parentNode.parentNode.rowIndex-1].cells[0].innerHTML);
               let name = table.rows[element.parentNode.parentNode.rowIndex-1].cells[0].innerHTML;
               table.deleteRow(element.parentNode.parentNode.rowIndex-1);
               fetch("../data?apiKey=qwertyuiop&todo=delete&symbol="+ name, 
                  res =>
                  res.json()
               ).then((res) => {
                  console.log(res);
                  window.changer = 1;
                  stateChange();
               });
            }
            function deleteRNFO(element)
            {
               console.log("working");
               window.changer = 0;
               let table = document.getElementById('table3');
               console.log(table.rows[element.parentNode.parentNode.rowIndex-1].cells[0].innerHTML);
               let name = table.rows[element.parentNode.parentNode.rowIndex-1].cells[0].innerHTML;
               table.deleteRow(element.parentNode.parentNode.rowIndex-1);
               fetch("../data?apiKey=qwertyuiop&todo=delete&symbol="+ name, 
                  res =>
                  res.json()
               ).then((res) => {
                  console.log(res);
                  window.changer = 1;
                  stateChange();
               });
            }
            function filter() {
                  var input, filter, table, tr, td, i, txtValue;
                  input = document.getElementById("search");
                  filter = input.value.toUpperCase();
                  table1 = document.getElementById("table1");
                  tr1 = table1.getElementsByTagName("tr");
                  for (i = 0; i < tr1.length; i++) {
                     td1 = tr1[i].getElementsByTagName("td")[0];
                     console.log(td);
                     if (td1) {
                     txtValue = td1.textContent || td1.innerText;
                     if (txtValue.toUpperCase().indexOf(filter) > -1) {
                           tr1[i].style.display = "";
                     } else {
                           tr1[i].style.display = "none";
                     }
                     }       
                  }
                  table2 = document.getElementById("table2");
                  tr2 = table2.getElementsByTagName("tr");
                  for (i = 0; i < tr2.length; i++) {
                     td2 = tr2[i].getElementsByTagName("td")[0];
                     console.log(td2);
                     if (td2) {
                     txtValue = td2.textContent || td2.innerText;
                     if (txtValue.toUpperCase().indexOf(filter) > -1) {
                           tr2[i].style.display = "";
                     } else {
                           tr2[i].style.display = "none";
                     }
                     }       
                  }
                  table3 = document.getElementById("table3");
                  tr3 = table3.getElementsByTagName("tr");
                  for (i = 0; i < tr3.length; i++) {
                     td3 = tr3[i].getElementsByTagName("td")[0];
                     console.log(td3);
                     if (td3) {
                     txtValue = td3.textContent || td3.innerText;
                     if (txtValue.toUpperCase().indexOf(filter) > -1) {
                           tr3[i].style.display = "";
                     } else {
                           tr3[i].style.display = "none";
                     }
                     }       
                  }
               }
            function DataUpdater()
            {
               // allow corss origin policy to work
               let fetchRes = fetch("../data/?apiKey=asdfghjkl");
               fetchRes.then(res =>
                  res.json()).then(d => {
                        let NSE = d['NSE'];
                        for(let i=0; i < NSE.length; i++)
                        {
                           let symbol = NSE[i]['name'];
                           let table = document.getElementById("table1");
                           let tr = table.getElementsByTagName("tr");
                           for(let j=0; j < tr.length; j++)
                           {
                              if(tr[j].cells[0].innerHTML == symbol)
                              {  
                                 let oldprice1 = tr[j].cells[1].innerHTML;
                                 oldprice1 = oldprice1.replace(',','')
                                 let newPrice1 = NSE[i]['ask'];
                                 newPrice1 = newPrice1.replace(',','');
                                 if(parseFloat(oldprice1.substring(1))>parseFloat(newPrice1.substring(1)))
                                 {
                                    tr[j].cells[1].innerHTML = NSE[i]['ask'];
                                    tr[j].cells[1].classList.add("bg-danger");
                                    tr[j].cells[1].classList.remove("bg-primary");
                                 }
                                 else
                                 {
                                    tr[j].cells[1].innerHTML = NSE[i]['ask'];
                                    tr[j].cells[1].classList.add("bg-primary");
                                    tr[j].cells[1].classList.remove("bg-danger");
                                 }
                                 let oldprice2 = tr[j].cells[2].innerHTML;
                                 oldprice2 = oldprice2.replace(',','')
                                 let newPrice2 = NSE[i]['bid'];
                                 newPrice = newPrice2.replace(',','');
                                 if(parseFloat(oldprice2.substring(1))>parseFloat(newPrice2.substring(1)))
                                 {
                                    tr[j].cells[2].innerHTML = NSE[i]['bid'];
                                    tr[j].cells[2].classList.add("bg-danger");
                                    tr[j].cells[2].classList.remove("bg-primary");
                                 }
                                 else
                                 {
                                    tr[j].cells[2].innerHTML = NSE[i]['bid'];
                                    tr[j].cells[2].classList.add("bg-primary");
                                    tr[j].cells[2].classList.remove("bg-danger");
                                 }
                                 let oldprice3 = tr[j].cells[3].innerHTML;
                                 oldprice3 = oldprice3.replace(',','')
                                 let newPrice3 = NSE[i]['last price'];
                                 newPrice3 = newPrice3.replace(',','');
                                 if(parseFloat(oldprice3.substring(1))>parseFloat(newPrice3.substring(1)))
                                 {
                                    tr[j].cells[3].innerHTML = NSE[i]['last price'];
                                    tr[j].cells[3].classList.add("bg-danger");
                                    tr[j].cells[3].classList.remove("bg-primary");
                                 }
                                 else
                                 {
                                    tr[j].cells[3].innerHTML = NSE[i]['last price'];
                                    tr[j].cells[3].classList.add("bg-primary");
                                    tr[j].cells[3].classList.remove("bg-danger");
                                 }
                                 let oldchange = tr[j].cells[9].innerText;
                                 oldchange = oldchange.replace(/\D/g, "");
                                 let newchange = NSE[i]['change'];
                                 newchange = newchange.replace(/\D/g, "");
                                 if(parseFloat(oldchange.substring(1))>parseFloat(newchange.substring(1)))
                                 {
                                    tr[j].cells[4].innerHTML = `<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-down" class="svg-inline--fa fa-caret-down " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="red"><path fill="currentColor" d="M310.6 246.6l-127.1 128C176.4 380.9 168.2 384 160 384s-16.38-3.125-22.63-9.375l-127.1-128C.2244 237.5-2.516 223.7 2.438 211.8S19.07 192 32 192h255.1c12.94 0 24.62 7.781 29.58 19.75S319.8 237.5 310.6 246.6z"></path></svg>`+ NSE[i]['change']+` %`;
                                 }
                                 else
                                 {
                                    tr[j].cells[4].innerHTML = `<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-up" class="svg-inline--fa fa-caret-up " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="green"><path fill="currentColor" d="M9.39 265.4l127.1-128C143.6 131.1 151.8 128 160 128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156 11.9 22.91 6.943 34.88S300.9 320 287.1 320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333 274.5 9.39 265.4z"></path></svg>`+ NSE[i]['change']+` %`;
                                 }
                                 tr[j].cells[5].innerHTML = NSE[i]['open'];
                                 tr[j].cells[6].innerHTML = NSE[i]['high'];
                                 tr[j].cells[7].innerHTML = NSE[i]['low'];
                                 tr[j].cells[8].innerHTML = NSE[i]['close'];
                              }
                           }
                        }
                        let MCX = d['MCX'];
                        for(let i=0; i < MCX.length; i++)
                        {
                           let symbol = MCX[i]['name'];
                           let table = document.getElementById("table2");
                           let tr = table.getElementsByTagName("tr");
                           for(let j=0; j < tr.length; j++)
                           {
                              if(tr[j].cells[0].innerHTML == symbol)
                              {  
                                 let oldprice1 = tr[j].cells[1].innerHTML;
                                 oldprice1 = oldprice1.replace(',','')
                                 let newPrice1 = MCX[i]['ask'];
                                 newPrice1 = newPrice1.replace(',','');
                                 if(parseFloat(oldprice1.substring(1))>parseFloat(newPrice1.substring(1)))
                                 {
                                    tr[j].cells[1].innerHTML = MCX[i]['ask'];
                                    tr[j].cells[1].classList.add("bg-danger");
                                    tr[j].cells[1].classList.remove("bg-primary");
                                 }
                                 else
                                 {
                                    tr[j].cells[1].innerHTML = MCX[i]['ask'];
                                    tr[j].cells[1].classList.add("bg-primary");
                                    tr[j].cells[1].classList.remove("bg-danger");
                                 }
                                 let oldprice2 = tr[j].cells[2].innerHTML;
                                 oldprice2 = oldprice2.replace(',','')
                                 let newPrice2 = MCX[i]['bid'];
                                 newPrice = newPrice2.replace(',','');
                                 if(parseFloat(oldprice2.substring(1))>parseFloat(newPrice2.substring(1)))
                                 {
                                    tr[j].cells[2].innerHTML = MCX[i]['bid'];
                                    tr[j].cells[2].classList.add("bg-danger");
                                    tr[j].cells[2].classList.remove("bg-primary");
                                 }
                                 else
                                 {
                                    tr[j].cells[2].innerHTML = MCX[i]['bid'];
                                    tr[j].cells[2].classList.add("bg-primary");
                                    tr[j].cells[2].classList.remove("bg-danger");
                                 }
                                 let oldprice3 = tr[j].cells[3].innerHTML;
                                 oldprice3 = oldprice3.replace(',','')
                                 let newPrice3 = MCX[i]['last price'];
                                 newPrice3 = newPrice3.replace(',','');
                                 if(parseFloat(oldprice3.substring(1))>parseFloat(newPrice3.substring(1)))
                                 {
                                    tr[j].cells[3].innerHTML = MCX[i]['last price'];
                                    tr[j].cells[3].classList.add("bg-danger");
                                    tr[j].cells[3].classList.remove("bg-primary");
                                 }
                                 else
                                 {
                                    tr[j].cells[3].innerHTML = MCX[i]['last price'];
                                    tr[j].cells[3].classList.add("bg-primary");
                                    tr[j].cells[3].classList.remove("bg-danger");
                                 }
                                 let oldchange = tr[j].cells[9].innerText;
                                 oldchange = oldchange.replace(/\D/g, "");
                                 let newchange = MCX[i]['change'];
                                 newchange = newchange.replace(/\D/g, "");
                                 if(parseFloat(oldchange.substring(1))>parseFloat(newchange.substring(1)))
                                 {
                                    tr[j].cells[4].innerHTML = `<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-down" class="svg-inline--fa fa-caret-down " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="red"><path fill="currentColor" d="M310.6 246.6l-127.1 128C176.4 380.9 168.2 384 160 384s-16.38-3.125-22.63-9.375l-127.1-128C.2244 237.5-2.516 223.7 2.438 211.8S19.07 192 32 192h255.1c12.94 0 24.62 7.781 29.58 19.75S319.8 237.5 310.6 246.6z"></path></svg>`+ MCX[i]['change']+` %`;
                                 }
                                 else
                                 {
                                    tr[j].cells[4].innerHTML = `<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-up" class="svg-inline--fa fa-caret-up " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="green"><path fill="currentColor" d="M9.39 265.4l127.1-128C143.6 131.1 151.8 128 160 128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156 11.9 22.91 6.943 34.88S300.9 320 287.1 320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333 274.5 9.39 265.4z"></path></svg>`+ MCX[i]['change']+` %`;
                                 }
                                 tr[j].cells[5].innerHTML = MCX[i]['open'];
                                 tr[j].cells[6].innerHTML = MCX[i]['high'];
                                 tr[j].cells[7].innerHTML = MCX[i]['low'];
                                 tr[j].cells[8].innerHTML = MCX[i]['close'];
                              }
                           }
                        }
                        let NFO = d['NFO'];
                        for(let i=0; i < NFO.length; i++)
                        {
                           let symbol = NFO[i]['name'];
                           let table = document.getElementById("table3");
                           let tr = table.getElementsByTagName("tr");
                           for(let j=0; j < tr.length; j++)
                           {
                              if(tr[j].cells[0].innerHTML == symbol)
                              {  
                                 let oldprice1 = tr[j].cells[1].innerHTML;
                                 oldprice1 = oldprice1.replace(',','')
                                 let newPrice1 = NFO[i]['ask'];
                                 newPrice1 = newPrice1.replace(',','');
                                 if(parseFloat(oldprice1.substring(1))>parseFloat(newPrice1.substring(1)))
                                 {
                                    tr[j].cells[1].innerHTML = NFO[i]['ask'];
                                    tr[j].cells[1].classList.add("bg-danger");
                                    tr[j].cells[1].classList.remove("bg-primary");
                                 }
                                 else
                                 {
                                    tr[j].cells[1].innerHTML = NFO[i]['ask'];
                                    tr[j].cells[1].classList.add("bg-primary");
                                    tr[j].cells[1].classList.remove("bg-danger");
                                 }
                                 let oldprice2 = tr[j].cells[2].innerHTML;
                                 oldprice2 = oldprice2.replace(',','')
                                 let newPrice2 = NFO[i]['bid'];
                                 newPrice = newPrice2.replace(',','');
                                 if(parseFloat(oldprice2.substring(1))>parseFloat(newPrice2.substring(1)))
                                 {
                                    tr[j].cells[2].innerHTML = NFO[i]['bid'];
                                    tr[j].cells[2].classList.add("bg-danger");
                                    tr[j].cells[2].classList.remove("bg-primary");
                                 }
                                 else
                                 {
                                    tr[j].cells[2].innerHTML = NFO[i]['bid'];
                                    tr[j].cells[2].classList.add("bg-primary");
                                    tr[j].cells[2].classList.remove("bg-danger");
                                 }
                                 let oldprice3 = tr[j].cells[3].innerHTML;
                                 oldprice3 = oldprice3.replace(',','')
                                 let newPrice3 = NFO[i]['last price'];
                                 newPrice3 = newPrice3.replace(',','');
                                 if(parseFloat(oldprice3.substring(1))>parseFloat(newPrice3.substring(1)))
                                 {
                                    tr[j].cells[3].innerHTML = NFO[i]['last price'];
                                    tr[j].cells[3].classList.add("bg-danger");
                                    tr[j].cells[3].classList.remove("bg-primary");
                                 }
                                 else
                                 {
                                    tr[j].cells[3].innerHTML = NFO[i]['last price'];
                                    tr[j].cells[3].classList.add("bg-primary");
                                    tr[j].cells[3].classList.remove("bg-danger");
                                 }
                                 let oldchange = tr[j].cells[9].innerText;
                                 oldchange = oldchange.replace(/\D/g, "");
                                 let newchange = NFO[i]['change'];
                                 newchange = newchange.replace(/\D/g, "");
                                 if(parseFloat(oldchange.substring(1))>parseFloat(newchange.substring(1)))
                                 {
                                    tr[j].cells[4].innerHTML = `<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-down" class="svg-inline--fa fa-caret-down " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="red"><path fill="currentColor" d="M310.6 246.6l-127.1 128C176.4 380.9 168.2 384 160 384s-16.38-3.125-22.63-9.375l-127.1-128C.2244 237.5-2.516 223.7 2.438 211.8S19.07 192 32 192h255.1c12.94 0 24.62 7.781 29.58 19.75S319.8 237.5 310.6 246.6z"></path></svg>`+ NFO[i]['change']+` %`;
                                 }
                                 else
                                 {
                                    tr[j].cells[4].innerHTML = `<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-up" class="svg-inline--fa fa-caret-up " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" color="green"><path fill="currentColor" d="M9.39 265.4l127.1-128C143.6 131.1 151.8 128 160 128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156 11.9 22.91 6.943 34.88S300.9 320 287.1 320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333 274.5 9.39 265.4z"></path></svg>`+ NFO[i]['change']+` %`;
                                 }
                                 tr[j].cells[5].innerHTML = NFO[i]['open'];
                                 tr[j].cells[6].innerHTML = NFO[i]['high'];
                                 tr[j].cells[7].innerHTML = NFO[i]['low'];
                                 tr[j].cells[8].innerHTML = NFO[i]['close'];
                              }
                           }
                        }
                  }) 
                  stateChange();
            }
            function stateChange()
            {
               setTimeout(function(){ 
                  if(window.changer==1)
                  {
                     DataUpdater();
                     console.log("Data Updater");
                  }
                  else
                  {
                     console.log("Stopped");
                  }
               }, 500);
            }
            function updateToNull(element)
            {  
               if(element.value == "Type Script")
               {
                  element.value = "";
               }
            }
            function scriptChanger(element)
            {
               
               if(element.value == "NSE")
               {
                  //http://192.168.1.2:8000/trading/scriptChanger/?segment=NSE
                  let fetchRes = fetch("../scriptChanger/?segment=NSE");
                  fetchRes.then(res =>
                  res.json()).then(d => {
                     var options = document.getElementById("scripts");
                     if(options.hasChildNodes) {
                        const emptyChild = options.cloneNode(false);
                        options.replaceWith(emptyChild);
                     }
                     var options = document.getElementById("scripts");
                     for(var i=0;i<d.length;i++)
                     {
                        var option = document.createElement("option");
                        option.value = d[i];
                        options.appendChild(option);
                     }
                  })               
               }
               if(element.value == "MCX")
               {
                  //5914
                  var options = document.getElementsByTagName("datalist")[0].options;
                  var count = 0;
                  {% for stock in stocksB %}
                     options[count].value = "{{stock}}";
                     count++;
                  {% endfor %}
               }
               if(element.value == "NFO")
               {
                  //63592
                  let fetchRes = fetch("../scriptChanger/?segment=NFO");
                  fetchRes.then(res =>
                  res.json()).then(d => {
                     var options = document.getElementById("scripts");
                     if(options.hasChildNodes) {
                        const emptyChild = options.cloneNode(false);
                        options.replaceWith(emptyChild);
                     }
                     var options = document.getElementById("scripts");
                     for(var i=0;i<d.length;i++)
                     {
                        var option = document.createElement("option");
                        option.value = d[i];
                        options.appendChild(option);
                     }
                  })       
               }
            }
            function ExpirySetter()
            {
               let segment = document.getElementById("segment").value;
               if (segment!="NSE")
               {
                  let script = document.getElementById("script").value;
                  let fetchRes = fetch("../scriptChanger/?segment="+segment+"&todo=expiry&script="+script);
                     fetchRes.then(res =>
                     res.json()).then(d => {
                        var options = document.getElementById("expiry");
                        if(options.hasChildNodes) {
                           const emptyChild = options.cloneNode(false);
                           options.replaceWith(emptyChild);
                        }
                        var options = document.getElementById("expiry");
                        for(var i=0;i<d.length;i++)
                        {
                           var option = document.createElement("option");
                           option.classList.add("bg-light");
                           option.classList.add("text-dark");
                           option.classList.add("ps-3");
                           option.value = d[i];
                           option.text = d[i];
                           options.appendChild(option);
                        }
                     })
               }
            }
            function StrikeSetter()
            {
               let segment = document.getElementById("segment").value;
               let script = document.getElementById("script").value;
               let expiry = document.getElementById("expiry").value;
               let typeCall = document.getElementById("typeCall").value;
               let fetchRes = fetch("../scriptChanger/?segment="+segment+"&todo=strike&script="+script+"&expiry="+expiry+"&typeCall="+typeCall);
                  fetchRes.then(res =>
                  res.json()).then(d => {
                     var options = document.getElementById("strike");
                     if(options.hasChildNodes) {
                        const emptyChild = options.cloneNode(false);
                        options.replaceWith(emptyChild);
                     }
                     var options = document.getElementById("strike");
                     for(var i=0;i<d.length;i++)
                     {
                        var option = document.createElement("option");
                        option.classList.add("bg-light");
                        option.classList.add("text-dark");
                        option.classList.add("ps-3");
                        option.value = d[i];
                        option.text = d[i];
                        options.appendChild(option);
                     }
                  })
            }
            stateChange();
        </script>
      {% endblock content %}